<!DOCTYPE html>
<html lang="ru">
<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=792, user-scalable=no">
	<meta http-equiv="x-ua-compatible" content="ie=edge">
	<link rel="stylesheet" href="content/components/shower-ribbon/styles/screen.css">
	<link rel="stylesheet" href="content/styles/presentation.css">
	<link rel="stylesheet" href="content/components/highlightjs/styles/default.css">
	<link rel="stylesheet" href="content/components/highlightjs/styles/monokai_sublime.css">
	<title>Сборка фронтенда</title>
</head>
<body class="list">
	<header class="caption">
		<h1>Сборка фронтенда</h1>
		<p>Дмитрий Швалёв (Ingenius Systems, 2014)</p>
	</header>

	<section class="slide cover cover-background" style="background-image: url('content/images/blueprint.jpg')" id="Cover">
		<div>
			<h2>Сборка фронтенда</h2>
			<p>Дмитрий Швалёв (Ingenius Systems, 2014)</p>
		</div>
	</section>

	<section class="slide"><div>
		<h2>Введение</h2>
		<ul>
			<li>
				<strong>Node.js</strong> (Node)
			</li>
			<li class="next">
				<strong>npm</strong> (Node Packed manager).
				<br>
				Менеджер сторонних пакетов. Входит в дистрибутив Node
			</li>
			<li class="next">
				Полюбить командную строку (<strong>консоль</strong>)
				<img src="content/images/unix-way.png" alt="">
			</li>
		</ul>
	</div></section>

	<section class="slide"><div>
		<h2>Инициализация пакета (проекта)</h2>
		<code class="console-prompt">npm init</code>
	</div></section>

	<section class="slide"><div>
		<img src="content/images/npm-init.png" alt="">
	</div></section>

	<section class="slide"><div>
		<img src="content/images/package.png" alt="">
	</div></section>

	<section class="slide cover cover-background" style="background-image: url('content/images/packages.jpg')"><div>
		<h2>Пакеты Node.js</h2>
	</div></section>

	<section class="slide"><div>
		<h2>Установка пакетов вручную</h2>
		<code class="console-prompt">npm install &lt;имя_пакета&gt;</code>
		<div><em>или</em></div>
		<code class="console-prompt">npm i &lt;имя_пакета&gt;</code> - сокращенный вариант
	</div></section>

	<section class="slide"><div>
		<h2>Установка пакетов вручную</h2>
		<h3>Флаги и ключи</h3>
		<ul>
			<li><code>-g</code> - флаг устанавки пакета глобально (для вызова из командной строки)</li>
			<li class="next"><code>--save</code> - ключ сохранения имени пакета в секцию dependencies файла package.json</li>
			<li class="next"><code>--save-dev</code> - ключ сохранения имени пакета в секцию devDependencies файла package.json</li>
		</ul>
	</div></section>

	<section class="slide"><div>
		<h2>Автоматическая установка пакетов</h2>
		<div>При наличии файла package.json с прописанными пакетами в каталоге проекта. <strong>Версия для разработки</strong>:</div>
		<code class="console-prompt">npm install</code>
		<div><em>или</em></div>
		<code class="console-prompt">npm i</code> - сокращенный вариант
		<blockquote class="note">
			При этом устанавливаются пакеты прописанные в секциях dependencies и в devDependencies
		</blockquote>
	</div></section>

	<section class="slide"><div>
		<h2>Автоматическая установка пакетов</h2>
		<div><strong>Продакшн версия</strong>:</div>
		<code class="console-prompt">npm install --production</code>
		<div><em>или</em></div>
		<code class="console-prompt">npm i --production</code> - сокращенный вариант
		<blockquote class="note">
			Пакеты из секции devDependencies установлены не будут
		</blockquote>
	</div></section>

	<section class="slide cover cover-background" style="background-image: url('content/images/buildings.jpg')"><div>
		<h2>Gulp-пакеты для сборки</h2>
	</div></section>

	<section class="slide"><div>
		<h2>Gulp.js (Gulp) - потоковый менеджер задач (task runner) для сборки проектов</h2>
		<div>Глобальная установка CLI-версии Gulp:</div>
		<ul>
			<li><code class="console-prompt">sudo npm install -g <strong>gulp</strong></code></li>
		</ul>
		<div>Установка локального менеджера задач</div>
		<ul>
			<li><code class="console-prompt">npm install <strong>gulp</strong> --save-dev</code></li>
		</ul>
	</div></section>

	<section class="slide"><div>
		<h2>Gulpfile.js</h2>
		<div><strong>Gulpfile</strong> - javascript файл описывающий подключение пакетов, задачи gulp и при необходимости сервисные функции</div>
		<code class="console-prompt">touch Gulpfile.js</code>
	</div></section>

	<section class="slide"><div>
		<h2>Gulpfile.js</h2>
		<p><code class="console-prompt">gulp</code></p>
		<img src="content/images/gulpfile-blank.png" alt="">
	</div></section>

	<section class="slide"><div>
		<h2>Gulpfile.js</h2>
		<pre><div class="code javascript">'use strict';

var gulp = require('gulp');

gulp.task('default', function() {
	console.log('default task');
});
		</div></pre>
	</div></section>

	<section class="slide"><div>
		<h2>Компиляция Less в Css</h2>
		<div><code class="console-prompt">npm install <strong>gulp-less</strong> --save-dev</code></div>
		<div><code class="console-prompt">npm install <strong>gulp-rename</strong> --save-dev</code></div>
	</div></section>

	<section class="slide"><div>
		<pre><div class="code javascript">var gulp = require('gulp'),
    rename = require('gulp-rename'),
    less = require('gulp-less');

gulp.task('buildcss', function() {
  return gulp.src('./styles.less')
             .pipe(less())
             .pipe(rename('styles.css'))
             .pipe(gulp.dest('./'));
});

gulp.task('default', ['buildcss']);
		</div></pre>
	</div></section>

	<section class="slide"><div>
		<h2>Autoprefixer, CSSO</h2>
		<div><code class="console-prompt">npm install <strong>gulp-autoprefixer</strong> --save-dev</code></div>
		<div><code class="console-prompt">npm install <strong>gulp-csso</strong> --save-dev</code></div>
		<div><code class="console-prompt">npm install <strong>gulp-load-plugins</strong> --save-dev</code></div>
	</div></section>

	<section class="slide"><div>
		<pre><div class="code javascript">var gulp = require('gulp'),
    plugins = require('gulp-load-plugins')();

gulp.task('buildcss', function() {
	return gulp.src('./styles.less')
	           .pipe(plugins.less())
	           .pipe(plugins.autoprefixer(
	              ['last 3 versions', 'ie 10', 'opera 12']
	            ))
	           .pipe(plugins.csso())
	           .pipe(plugins.rename('styles.min.css'))
	           .pipe(gulp.dest('./app/styles'));
});

gulp.task('default', ['buildcss']);
		</div></pre>
	</div></section>

	<section class="slide"><div>
		<h2>Шаблоны имён файлов</h2>
		<ul>
			<li><code>'*.js'</code> - любое имя файла</li>
			<li><code>'filename.*'</code> - любое расширение</li>
			<li><code>'/*/filename.js'</code> - любой каталог</li>
			<li><code>'/**/*.js'</code> - любой вложенный каталог</li>
			<li><code>'/{foo,bar}/*.js'</code> - каталог foo или bar</li>
			<li><code>'/fonts/*.{ttf,svg,woff}'</code> - файл ttf, svg или woff</li>
			<li><code>['filename.*', '!*.css']</code> - любое расширение кроме css</li>
		</ul>
	</div></section>

	<section class="slide"><div>
		<h2>Watch. Мониторинг изменений</h2>
		<p><code class="console-prompt">gulp watch</code></p>
		<pre><div class="code javascript">gulp.task('watch', function() {
	gulp.watch(['*.less'], ['buildcss']);
});
		</div></pre>
		<div>Запуск мониторинга <code>gulp.watch</code></div>
		<div>При изменениях в любом файле с расширением less в текущем каталоге запускается задача buildcss</div>
	</div></section>

	<section class="slide"><div>
		<h2>Обработка ошибок</h2>
		<pre><div class="code javascript">gulp.task('buildcss', function() {
    return gulp.src('./styles.less')
           .pipe(plugins.less())
           .on('error', function(error) {
             console.log(error);
             this.end();
           })
           .pipe(plugins.autoprefixer(
             ['last 3 versions', 'ie 10', 'opera 12']
           ))
           .pipe(plugins.csso())
           .pipe(plugins.rename('styles.min.css'))
           .pipe(gulp.dest('./app/styles'));
});
		</div></pre>
	</div></section>

	<section class="slide"><div>
		<h2>Livereload. Автоматическое обновление</h2>
		<div><code class="console-prompt">npm install <strong>connect</strong> --save-dev</code></div>
		<div><code class="console-prompt">npm install <strong>serve-static</strong> --save-dev</code></div>
		<div><code class="console-prompt">npm install <strong>connect-livereload</strong> --save-dev</code></div>
		<div><code class="console-prompt">npm install <strong>gulp-livereload</strong> --save-dev</code></div>
	</div></section>

	<section class="slide"><div>
		<h3>Livereload. Задача server</h3>
		<pre><div class="code javascript">gulp.task('server', function(next) {
    var server = require('connect')(),
        servestatic = require('serve-static');

    server.use(require('connect-livereload')({
        port: 35729
    }));

    server.use(servestatic('./app', {
        'index': ['index.html', 'index.htm']
    }));

    server.listen(3000, next);
});
		</div></pre>
	</div></section>

	<section class="slide"><div>
		<h3>Livereload. Задача watch</h3>
		<pre><div class="code javascript">gulp.task('watch', ['server'], function() {
	var liveserver = plugins.livereload();

	gulp.watch(['*.less'], ['buildcss']);

	gulp.watch([
		'./app/styles/*.css'
	]).on('change', function(file) {
		liveserver.changed(file.path);
	});
});
		</div></pre>
	</div></section>

	<section class="slide cover cover-background" style="background-image: url('content/images/next.jpg')"><div>
	</div></section>

	<section class="slide"><div>
		<h2>Jade <span style="font-weight: 100;">[jād]</span>. Node Template Engine</h2>
		<pre><div class="code jade">doctype html
	html(lang="en")
		head
			title= pageTitle
			script(src='jquery.min.js')
		body
			h1 Jade - node template engine
			#container.col
				if youAreUsingJade
					p You are amazing
				else
					p Get on it!
				p.
					Jade is a terse and simple language with a
					strong focus on performance powerful features.
	</div></pre>
	</div></section>

	<section class="slide"><div>
		<h3>Jade. Задача компиляции шаблона</h3>
		<p><code class="console-prompt">npm install <strong>gulp-jade</strong> --save-dev</code></p>
		<pre><div class="code javascript">gulp.task('template', function() {
    return gulp.src('./index.jade')
               .pipe(plugins.jade())
               .on('error', function(error) {
                 console.log(error);
                 this.end();
               })
               .pipe(gulp.dest('./app'));
});
		</div></pre>
	</div></section>

	<section class="slide"><div>
		<h3>Jade. Мониторинг и обновление</h3>
		<pre><div class="code javascript">gulp.task('watch', ['server'], function() {
	var liveserver = plugins.livereload();

	gulp.watch(['*.less'], ['buildcss']);

	gulp.watch(['*.jade'], ['template']);

	gulp.watch([
		'./app/styles/*.css',
		'./app/*.html'
	]).on('change', function(file) {
		liveserver.changed(file.path);
	});
});
		</div></pre>
	</div></section>

	<section class="slide cover cover-background" style="background-image: url('content/images/1396367592193_big.jpg')"><div>
	</div></section>

	<section class="slide"><div>
		<h2>Ссылки</h2>
		<ul>
			<li>http://goo.gl/HANXZi</li>
		</ul>

		<img src="http://chart.googleapis.com/chart?cht=qr&chs=250x250&choe=UTF-8&chld=H&chl=http://goo.gl/HANXZi" alt="">
	</div></section>

	<div class="progress"><div></div></div>
	<script src="content/components/shower-core/shower.min.js"></script>
	<script src="content/components/highlightjs/highlight.pack.js"></script>
	<script>
		var code = document.querySelectorAll('pre .code');
		for (b in code) {
			hljs.highlightBlock(code[b]);
		}
	</script>
</body>
</html>
